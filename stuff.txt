CREATE PROCEDURE [dbo].[driverStat_inRace]
	@driverId int = 98091313,
	@raceId int = 97106601
AS
	DECLARE @retVal Table(Driver_Id int, Race_Id int, TotalPoints int, FirstPlace int, SecondPlace int, ThirdPlace int, Podiums int)

	declare @totPoints int = (Select sum(Points) from Results where Driver_id like @driverId AND Race_id like @raceId)
	declare @firstPlace int = (select count(*) from Results where Driver_id like @driverId AND Race_id like @raceId AND Position like 1)
	declare @secondPlace int = (select count(*) from Results where Driver_id like @driverId AND Race_id like @raceId AND Position like 2)
	declare @thirdPlace int = (select count(*) from Results where Driver_id like @driverId AND Race_id like @raceId AND Position like 3)
	declare @podiums int = (select count(*) from Results where Driver_id like @driverId AND Race_id like @raceId AND (Position like 3 OR Position like 2 OR Position like 1))

	Insert into @retVal(Driver_Id, Race_Id) (Select @driverId, @raceId, @totPoints, @firstPlace, @secondPlace, @thirdPlace, @podiums)

	SELECT * FROM @retVal;
RETURN 0